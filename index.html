<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>RIEMON - Dashboard</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdn.lordicon.com/lordicon.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "riemon-green": "#16c72e",
              "riemon-green-dark": "#109121",
              "riemon-green-light": "#9cf4a7",
              "riemon-gray": "#f8f9fa",
            },
          },
        },
      };
    </script>

  </head>
  <body class="bg-riemon-gray">
    <div class="container mx-auto py-10 px-4">
      <div class="text-center mb-10 slide-in">
        <div class="inline-block gradient-bg px-8 py-4 rounded-2xl mb-4">
          <h1 class="text-6xl font-bold text-white mb-2 drop-shadow-lg">
            RIEMON
          </h1>
          <h3 class="text-xl text-white font-medium">
            - Riega con Precisi√≥n, Riega con Pasi√≥n -
          </h3>
        </div>
        <div class="flex items-center justify-center gap-2 mt-4">
          <div class="w-3 h-3 bg-riemon-green rounded-full animate-pulse"></div>
          <p class="text-gray-600">
            √öltima actualizaci√≥n:
            <span id="last-updated" class="font-semibold text-riemon-green-dark"
              >--:--:--</span
            >
          </p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div
          class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center text-center hover-scale card-animate"
        >
          <div class="float-animation">
            <lord-icon
              src="https://cdn.lordicon.com/jtslwgho.json"
              trigger="loop"
              delay="1000"
              colors="primary:#109121,secondary:#9cf4a7"
              style="width: 80px; height: 80px"
            >
            </lord-icon>
          </div>
          <h5 class="text-lg font-semibold text-gray-700 mt-2">
            Humedad del Suelo
          </h5>
          <p id="soil-humidity" class="text-5xl font-bold text-blue-600 my-2">
            -- %
          </p>
          <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
            <div
              id="soil-bar"
              class="bg-blue-600 h-2.5 rounded-full transition-all duration-500"
              style="width: 0%"
            ></div>
          </div>
          <small class="text-gray-500 mt-2">√ìptimo: 40-70%</small>
        </div>

        <div
          class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center text-center hover-scale card-animate">
          <div class="float-animation" style="animation-delay: 0.5s">
            <lord-icon
              src="https://cdn.lordicon.com/kikjlzqr.json"
              trigger="loop"
              state="loop-cycle"
              style="width:80px;height:80px">
            </lord-icon>
          </div>
          <h5 class="text-lg font-semibold text-gray-700 mt-2">
            Temp. Ambiente
          </h5>
          <p id="ambient-temp" class="text-5xl font-bold text-red-500 my-2">
            -- ¬∞C
          </p>
          <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
            <div
              id="temp-bar"
              class="bg-red-500 h-2.5 rounded-full transition-all duration-500"
              style="width: 0%"
            ></div>
          </div>
          <small class="text-gray-500 mt-2">√ìptimo: 18-28¬∞C</small>
        </div>

        <div
          class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center text-center hover-scale card-animate"
        >
          <div class="float-animation" style="animation-delay: 1s">
            <lord-icon
                src="https://cdn.lordicon.com/btvefodi.json"
                trigger="hover"
                style="width:80px;height:80px">
            </lord-icon>   
          </div>
          <h5 class="text-lg font-semibold text-gray-700 mt-2">
            Humedad Ambiente
          </h5>
          <p
            id="ambient-humidity"
            class="text-5xl font-bold text-cyan-500 my-2"
          >
            -- %
          </p>
          <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
            <div
              id="humidity-bar"
              class="bg-cyan-500 h-2.5 rounded-full transition-all duration-500"
              style="width: 0%"
            ></div>
          </div>
          <small class="text-gray-500 mt-2">√ìptimo: 50-80%</small>
        </div>

        <div
          class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center text-center hover-scale card-animate"
        >
          <div class="float-animation" style="animation-delay: 1.5s">
            <lord-icon
                src="https://cdn.lordicon.com/rfncegwc.json"
                trigger="loop"
                state="loop-spin"
                style="width: 80px; height: 80px">
            </lord-icon>
          </div>
          <h5 class="text-lg font-semibold text-gray-700 mt-2">
            Luz Solar (Lux)
          </h5>
          <p id="sun-light" class="text-5xl font-bold text-yellow-500 my-2">
            --
          </p>
          <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
            <div
              id="light-bar"
              class="bg-yellow-500 h-2.5 rounded-full transition-all duration-500"
              style="width: 0%"
            ></div>
          </div>
          <small class="text-gray-500 mt-2">√ìptimo: 10,000+ lx</small>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
        <div
          class="bg-white rounded-xl shadow-lg p-6 hover-scale card-animate lg:col-span-2"
        >
          <div class="flex items-center justify-between mb-4">
            <h4
              class="text-2xl font-bold text-gray-800 flex items-center gap-2"
            >
              <lord-icon
                src="https://cdn.lordicon.com/qcvtqfpg.json"
                trigger="loop"
                colors="primary:#109121,secondary:#f4b600"
                style="width: 40px; height: 40px"
              >
              </lord-icon>
              Pron√≥stico Semanal
            </h4>
            <p
              id="current-location"
              class="text-sm text-gray-500 font-semibold"
            >
              üìç Cargando...
            </p>
          </div>

          <div
            class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3"
            id="weekly-forecast"
          ></div>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6 hover-scale card-animate">
          <div class="text-center mb-4">
            <lord-icon
              id="weather-icon-dynamic"
              src="https://cdn.lordicon.com/qcvtqfpg.json"
              trigger="loop"
              delay="2000"
              colors="primary:#109121,secondary:#f4b600"
              style="width: 100px; height: 100px"
            >
            </lord-icon>
          </div>
          <h5 class="text-xl font-bold text-center text-gray-700 mb-2">
            Clima Actual
          </h5>
          <p
            id="weather-location"
            class="text-lg font-semibold text-center text-riemon-green-dark mb-2"
          >
            --
          </p>
          <p
            id="weather-temp"
            class="text-6xl font-bold text-center text-orange-500 mb-2"
          >
            --¬∞C
          </p>
          <p
            id="weather-desc"
            class="text-center text-gray-600 capitalize font-medium"
          >
            Cargando datos...
          </p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div
          class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center text-center hover-scale card-animate"
        >
          <lord-icon
            id="pump-icon"
            src="https://cdn.lordicon.com/frjgvxbn.json"
            trigger="loop"
            delay="1000"
            colors="primary:#848484,secondary:#e4e4e4"
            style="width: 100px; height: 100px"
          >
          </lord-icon>
          <h5 class="text-xl font-semibold text-gray-700 mt-4">
            Estado de la Bomba
          </h5>
          <div class="flex items-center justify-center my-4">
            <div
              id="pump-status-dot"
              class="w-5 h-5 rounded-full bg-gray-400 mr-3"
            ></div>
            <p id="pump-status-text" class="text-5xl font-bold text-gray-500">
              --
            </p>
          </div>
          <small class="text-gray-500 text-base">Encendida / Apagada</small>
        </div>

        <div
          class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center text-center hover-scale card-animate"
        >
          <lord-icon
            id="plant-icon"
            src="https://cdn.lordicon.com/zldkegty.json"
            trigger="loop"
            delay="2500"
            colors="primary:#16c72e,secondary:#a8e0b0"
            style="width: 100px; height: 100px"
          >
          </lord-icon>
          <h5 class="text-xl font-semibold text-gray-700 mt-4">
            Estado de la Planta
          </h5>
          <div class="flex items-center justify-center my-4">
            <div
              id="plant-status-dot"
              class="w-5 h-5 rounded-full bg-gray-400 mr-3"
            ></div>
            <p id="plant-status-text" class="text-5xl font-bold text-gray-500">
              --
            </p>
          </div>
          <small class="text-gray-500 text-base">Saludable / Estresada</small>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const weatherIconMap = {
          0: {
            desc: "Despejado",
            icon: "https://cdn.lordicon.com/flvisirw.json",
            colors: "primary:#f4b600,secondary:#fce596",
            emoji: "‚òÄÔ∏è",
          },
          1: {
            desc: "Principalmente despejado",
            icon: "https://cdn.lordicon.com/qcvtqfpg.json",
            colors: "primary:#f4b600,secondary:#cce5f4",
            emoji: "üå§Ô∏è",
          },
          2: {
            desc: "Parcialmente nublado",
            icon: "https://cdn.lordicon.com/qcvtqfpg.json",
            colors: "primary:#f4b600,secondary:#cce5f4",
            emoji: "‚õÖ",
          },
          3: {
            desc: "Nublado",
            icon: "https://cdn.lordicon.com/wmxtmfpb.json",
            colors: "primary:#a4d3f4,secondary:#cce5f4",
            emoji: "‚òÅÔ∏è",
          },
          45: {
            desc: "Niebla",
            icon: "https://cdn.lordicon.com/ayhtotha.json",
            colors: "primary:#a4d3f4,secondary:#cce5f4",
            emoji: "üå´Ô∏è",
          },
          48: {
            desc: "Niebla densa",
            icon: "https://cdn.lordicon.com/ayhtotha.json",
            colors: "primary:#a4d3f4,secondary:#cce5f4",
            emoji: "üå´Ô∏è",
          },
          51: {
            desc: "Llovizna ligera",
            icon: "https://cdn.lordicon.com/vjndwxlc.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "üå¶Ô∏è",
          },
          53: {
            desc: "Llovizna moderada",
            icon: "https://cdn.lordicon.com/vjndwxlc.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "üåßÔ∏è",
          },
          55: {
            desc: "Llovizna intensa",
            icon: "https://cdn.lordicon.com/vjndwxlc.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "üåßÔ∏è",
          },
          61: {
            desc: "Lluvia ligera",
            icon: "https://cdn.lordicon.com/yyecauzv.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "üåßÔ∏è",
          },
          63: {
            desc: "Lluvia moderada",
            icon: "https://cdn.lordicon.com/yyecauzv.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "üåßÔ∏è",
          },
          65: {
            desc: "Lluvia intensa",
            icon: "https://cdn.lordicon.com/yyecauzv.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "‚õàÔ∏è",
          },
          80: {
            desc: "Chubascos ligeros",
            icon: "https://cdn.lordicon.com/ymrqtppd.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "üå¶Ô∏è",
          },
          81: {
            desc: "Chubascos moderados",
            icon: "https://cdn.lordicon.com/ymrqtppd.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "üåßÔ∏è",
          },
          82: {
            desc: "Chubascos violentos",
            icon: "https://cdn.lordicon.com/ymrqtppd.json",
            colors: "primary:#40a1e5,secondary:#cce5f4",
            emoji: "‚õàÔ∏è",
          },
          95: {
            desc: "Tormenta",
            icon: "https://cdn.lordicon.com/yvjfzxwk.json",
            colors: "primary:#f4b600,secondary:#40a1e5",
            emoji: "‚õàÔ∏è",
          },
        };

        const weatherIconEl = document.getElementById("weather-icon-dynamic");
        const weatherLocationEl = document.getElementById("weather-location");
        const weatherTempEl = document.getElementById("weather-temp");
        const weatherDescEl = document.getElementById("weather-desc");
        const weeklyForecastEl = document.getElementById("weekly-forecast");
        const currentLocationEl = document.getElementById("current-location");

        function fetchWeather(lat, lon) {
          const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`;
          fetch(url)
            .then((response) => response.json())
            .then((data) => {
              const temp = Math.round(data.current.temperature_2m);
              const wmoCode = data.current.weather_code;
              const location = data.timezone.split("/").pop().replace("_", " ");
              const weatherInfo = weatherIconMap[wmoCode] || weatherIconMap[0];

              weatherLocationEl.innerText = location;
              weatherTempEl.innerText = `${temp}¬∞C`;
              weatherDescEl.innerText = weatherInfo.desc;
              weatherIconEl.setAttribute("src", weatherInfo.icon);
              weatherIconEl.setAttribute("colors", weatherInfo.colors);
              currentLocationEl.innerText = `üìç ${location}`;

              const days = ["Dom", "Lun", "Mar", "Mi√©", "Jue", "Vie", "S√°b"];
              const today = new Date().getDay();

              weeklyForecastEl.innerHTML = "";
              for (let i = 0; i < 7; i++) {
                const dayIndex = (today + i) % 7;
                const dayName = i === 0 ? "Hoy" : days[dayIndex];
                const maxTemp = Math.round(data.daily.temperature_2m_max[i]);
                const minTemp = Math.round(data.daily.temperature_2m_min[i]);
                const dayWeatherCode = data.daily.weather_code[i];
                const dayWeather =
                  weatherIconMap[dayWeatherCode] || weatherIconMap[0];

                const dayCard = document.createElement("div");
                dayCard.className =
                  "weather-day bg-gray-50 rounded-lg p-3 text-center border border-gray-200";
                dayCard.innerHTML = `
                                <p class="font-semibold text-gray-700 text-sm mb-2">${dayName}</p>
                                <div class="text-3xl mb-2">${dayWeather.emoji}</div>
                                <p class="text-lg font-bold text-gray-800">${maxTemp}¬∞</p>
                                <p class="text-sm text-gray-500">${minTemp}¬∞</p>
                            `;
                weeklyForecastEl.appendChild(dayCard);
              }
            })
            .catch((error) => {
              console.error("Error fetching weather:", error);
              weatherDescEl.innerText = "Error al cargar clima";
            });
        }

        function getLocation() {
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
              (position) => {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;
                fetchWeather(lat, lon);
              },
              (error) => {
                weatherDescEl.innerText = "Permiso de ubicaci√≥n denegado.";
                fetchWeather(32.5149, -117.0382);
              }
            );
          } else {
            weatherDescEl.innerText = "Geolocalizaci√≥n no soportada.";
          }
        }

        function updateClock() {
          const now = new Date();
          document.getElementById("last-updated").innerText =
            now.toLocaleTimeString();
        }

        function simulateData() {
          const soilHumidity = (Math.random() * 30 + 35).toFixed(1);
          const ambientTemp = (Math.random() * 5 + 20).toFixed(1);
          const ambientHumidity = (Math.random() * 20 + 55).toFixed(1);
          const sunLight = Math.floor(Math.random() * 5000 + 10000);

          document.getElementById(
            "soil-humidity"
          ).innerText = `${soilHumidity} %`;
          document.getElementById(
            "ambient-temp"
          ).innerText = `${ambientTemp} ¬∞C`;
          document.getElementById(
            "ambient-humidity"
          ).innerText = `${ambientHumidity} %`;
          document.getElementById("sun-light").innerText = sunLight;

          document.getElementById("soil-bar").style.width = `${
            (soilHumidity / 100) * 100
          }%`;
          document.getElementById("temp-bar").style.width = `${
            (ambientTemp / 40) * 100
          }%`;
          document.getElementById(
            "humidity-bar"
          ).style.width = `${ambientHumidity}%`;
          document.getElementById("light-bar").style.width = `${
            (sunLight / 20000) * 100
          }%`;

          const pumpText = document.getElementById("pump-status-text");
          const pumpDot = document.getElementById("pump-status-dot");
          const pumpIcon = document.getElementById("pump-icon");
          if (Math.random() > 0.7) {
            pumpText.innerText = "ON";
            pumpText.className = "text-5xl font-bold text-riemon-green";
            pumpDot.className =
              "w-5 h-5 rounded-full bg-riemon-green animate-pulse mr-3";
            pumpIcon.setAttribute(
              "colors",
              "primary:#16c72e,secondary:#a8e0b0"
            );
          } else {
            pumpText.innerText = "OFF";
            pumpText.className = "text-5xl font-bold text-gray-500";
            pumpDot.className = "w-5 h-5 rounded-full bg-gray-400 mr-3";
            pumpIcon.setAttribute(
              "colors",
              "primary:#848484,secondary:#e4e4e4"
            );
          }

          const plantText = document.getElementById("plant-status-text");
          const plantDot = document.getElementById("plant-status-dot");
          const plantIcon = document.getElementById("plant-icon");
          if (Math.random() > 0.1) {
            plantText.innerText = "Saludable";
            plantText.className = "text-4xl font-bold text-riemon-green";
            plantDot.className = "w-5 h-5 rounded-full bg-riemon-green mr-3";
            plantIcon.setAttribute(
              "colors",
              "primary:#16c72e,secondary:#a8e0b0"
            );
          } else {
            plantText.innerText = "Estresada";
            plantText.className = "text-4xl font-bold text-red-500";
            plantDot.className = "w-5 h-5 rounded-full bg-red-500 mr-3";
            plantIcon.setAttribute(
              "colors",
              "primary:#e83a30,secondary:#f49894"
            );
          }

          updateClock();
        }

        getLocation();
        simulateData();
        setInterval(simulateData, 3000);
      });
    </script>
  </body>
</html>
